!function(){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var s=Array.prototype.slice.call(arguments,1),i=this,e=function(){},r=function(){return i.apply(this instanceof e?this:t||window,s.concat(Array.prototype.slice.call(arguments)))};return e.prototype=this.prototype,r.prototype=new e,r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,s){for(var i=s||0,e=this.length;e>i;i++)if(this[i]===t)return i;return-1}),similarproducts.Template={blocks:{},vars:{},pub:{},blocksPattern:/\[([A-Z0-9_\.]+?)\](.*?)\[\/\1\]/gim,preProcessors:{cleaning:[/<\!--[\s\S]*?-->|\r|\t|\n|\s{2,}/gm,""],tokens:[/#\{(.+?)\}/gi,"<!--|-->$1<!--|-->"],ifTag:[/<if\s+(.+?)>/gi,"<!--|-->function(){if($1) {return [''<!--|-->"],elseIfTag:[/<\/if>\s*?<else if\s+(.+?)>/gi,"<!--|-->''].join('')} else if ($1) {return [''<!--|-->"],elseTag:[/<\/if>\s*?<else>/gi,"<!--|-->''].join('')} else {return [''<!--|-->"],ifElseCloseTag:[/<\/(if|else)>/gi,"<!--|-->''].join('')}}.call(this)<!--|-->"],foreachTag:[/<foreach\s+(.+?)(?:\s+in\s+(.+?)(?:\s+as\s+(.+?))?)?>/gi,function(t,s,i,e){return e=e||"t._item",i=i||s,s=s||"t._index","<!--|-->function(struct){var t=struct, _t="+i+", _r=[]; if (_t && _t.length){for(var i=0, l=_t.length; i<l; i++){t=_t[i]; t._parent=struct; "+s+" = i; "+e+" = t; _r.push([''<!--|-->"}],foreachCloseTag:[/<\/foreach>/gi,"<!--|-->''].join(''));} return _r.join('')}}.call(this, t)<!--|-->"],forTag:[/<for\s+(.+?)>/gi,"<!--|-->function(){var _r=[]; for($1){_r.push([''<!--|-->"],forCloseTag:[/<\/for>/gi,"<!--|-->''].join(''));} return _r.join('')}.call(this)<!--|-->"],scriptTag:[/<script(?:\s.+?)?>(.*?)<\/script>/gim,"<!--|-->function(){$1}.call(this)<!--|-->"],linkedBlockTag:[/<@(.+?)(?:\s+(.+?))?\s?\/>/gi,function(t,s,i){return i?"<!--|-->this._rd('"+s+"', "+i+")<!--|-->":"<!--|-->this._rd('"+s+"', t."+s+"||t)<!--|-->"}]},initialize:function(t){this.pub={_fv:this.findVar,_rd:this.render,vars:this.vars,blocks:this.blocks},t&&this.add(t)},parse:function(t){var s={},i=null,e,r,p,o;for(var a in this.preProcessors)this.preProcessors.hasOwnProperty(a)&&(e=this.preProcessors[a],t=t.replace(e[0],e[1]));do if(i=this.blocksPattern.exec(t)){r=i[2],p=[],r=r.split("<!--|-->");for(var n=0,u=r.length;u>n;n++)o=r[n],o&&p.push(n%2===1?o.replace(/\$([A-Z0-9_\.]+)/gi,"t.$1").replace(/\@([A-Z0-9_\.]+)/gi,"this._fv(t, '$1')").replace(/\^([A-Z0-9_\.]+)/gi,"this.vars.$1"):"'"+o.replace(/'/g,"\\'")+"'");s[i[1]]="t._parent = this.vars; return ["+p.join(",")+'].join("");'}while(i);return s},compile:function(t){for(var s in t)t.hasOwnProperty(s)&&(this.blocks[s]=new Function("t",t[s]))},render:function(t,s){return s=s||{},this.blocks[t]?this.blocks[t].call(this.pub,s):void 0},add:function(t){this.compile("string"==typeof t?this.parse(t):t)},findVar:function(t,s){return t[s]?t[s]:t._parent?this._fv(t._parent,s):""}},similarproducts.Draggable=function(t,s){function i(){s=s||{},u=spsupport.p.$(document),c=s.handle||t,c.mousedown(e)}function e(i){var e=t.offset();a=i.pageX-e.left,n=i.pageY-e.top,s.onDragStart&&s.onDragStart(i),u.mousemove(r),u.mouseup(p)}function r(i){o=!0,t.offset({left:i.pageX-a,top:i.pageY-n}),s.onDragging&&s.onDragging(i)}function p(t){s.onDragEnd&&s.onDragEnd(t,o),u.unbind("mousemove",r),u.unbind("mouseup",p),o=!1}var t=t,o=!1,a,n,u,c;return i(),this},spsupport.p={sfDomain:similarproducts.b.pluginDomain,sfDomain_:similarproducts.b.pluginDomain,imgPath:(similarproducts.b.sm?similarproducts.b.pluginDomain.replace("http:","https:"):similarproducts.b.pluginDomain.replace("https","http"))+"images/",cdnUrl:similarproducts.b.cdnUrl,appVersion:similarproducts.b.appVersion,clientVersion:similarproducts.b.clientVersion,site:similarproducts.b.pluginDomain,sessRepAct:"trackSession.action",isIE:0,isIEQ:5==+document.documentMode?1:0,applTb:0,applTbVal:30,siteDomain:"",sgDualResults:!1,presFt:"",sfIcon:{picMaxWidth:600,maxSmImg:{w:88,h:70},ic:0,evl:"sfimgevt",icons:[],labels:null,an:0,imPos:0,timer:0},onFocus:-1,psuHdrHeight:22,psuRestHeight:26,oopsTm:0,iconTm:0,dlsource:similarproducts.b.dlsource,w3iAFS:similarproducts.b.w3iAFS,CD_CTID:similarproducts.b.CD_CTID,userid:similarproducts.b.userid,statsReporter:similarproducts.b.statsReporter,minImageArea:3600,aspectRatio:.5,supportedSite:0,ifLoaded:0,ifExLoading:0,itemsNum:1,tlsNum:1,statSent:0,blSite:0,pipFlow:0,icons:0,jqueryFrame:0,partner:similarproducts.b.partnerCustomUI?similarproducts.b.images+"/":"",prodPage:{s:0,i:0,p:0,e:0,d:210,l:1e3,reset:function(){this.s=0,this.i=0,this.p=0,this.e=0}},SRP:{p:[],i:0,c:0,ind:0,lim:0,reset:function(){this.p=[],this.i=0,this.c=0,this.ind=0}},bh:{x1:0,y1:0,x2:0,y2:0,busy:0,tm:0},pageType:"NA",iJq:0,jJqcb:0,iSf:0,iTpc:0,iCpnWl:0,iCpn:0,iCharmSavings:0,messangerInitialized:0,before:-1,activeAreas:[],documentHeight:0},spsupport.api={jsonpRequest:function(t,s,i,e,r){var p={url:t,data:s,success:i,error:e,dataType:"jsonp",cache:!0};r&&(p.jsonpCallback=r),spsupport.p.$.ajax(p)},sTime:function(t){if(0==t)this.sTB=(new Date).getTime(),this.sT=0;else{if(1!=t)return 1==spsupport.p.before&&0==this.sT?(new Date).getTime()-this.sTB:this.sT;this.sT=(new Date).getTime()-this.sTB}},getDomain:function(){var t=spsupport.p.siteDomain||similarproducts.utilities.extractDomainName(document.location.host);return spsupport.p.siteDomain=t,t},validDomain:function(){try{var t=document;return null==t||null==t.domain||void 0==t||void 0==t.domain||""==t.domain||"about:blank"==t.location||"about:Tabs"==t.location||t.location.toString().indexOf("best-deals-products.com/congratulation.jsp")>-1||t.location.toString().indexOf("superfish.com/congratulation.jsp")>-1?!1:/^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,5}$/.test(t.domain)}catch(s){return!1}},init:function(){var t=spsupport.p;if(similarproducts.b.ignoreWL||spsupport.api.validDomain())if(t.textOnly=0,similarproducts.utilities.blacklistHandler.isWSBlacklist()||similarproducts.utilities.blacklistHandler.isPageBlacklist())similarproducts.utilities.sfWatcher.complete("WS blacklist"),spsupport.p.blSite=1,"function"==typeof window.similarProductsNoSearch&&window.similarProductsNoSearch('{"message":"is blacklist"}');else if(!t.iJq){t.iJq=1,similarproducts.b.cdnJQUrl=similarproducts.b.sm?similarproducts.b.cdnJQUrl.replace("http:","https:"):similarproducts.b.cdnJQUrl;var s=document.createElement("iframe");s.style.position="absolute",s.style.width="1px",s.style.height="1px",s.style.top="0",s.style.left="0",s.style.visibility="hidden",document.body.appendChild(s);try{t.wnd=s.contentWindow||s.contentDocument,t.wnd.document.open(),t.wnd.document.write("<!DOCTYPE html><html><head>"),t.wnd.document.write('<script type="text/javascript">var ga = document.createElement("script"); ga.type = "text/javascript"; ga.src = "'+similarproducts.b.cdnJQUrl+'"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s); </script>'),t.wnd.document.write('<script type="text/javascript">parent.spsupport.api.onJqLoad(1);</script>'),t.wnd.document.write("</head><body></body></html>"),t.wnd.document.close(),t.jqueryFrame=1}catch(i){sfjq.load({url:similarproducts.b.cdnJQUrl,callback:function(){t.jJqcb||(t.jJqcb=1,t.$=sfjq.jq,spsupport.api.jQLoaded())}})}}},sSrp:function(){var t=spsupport.p,s=spsupport.api,i=t.SRP.p[t.SRP.ind];t.pageType=spsupport.whiteStage.rv||spsupport.p.textOnly?"PP":"SRP",t.SRP.c<t.SRP.lim&&t.SRP.ind<t.SRP.p.length&&(t.SRP.ind++,"1"!=i.getAttribute("nosureq")&&s.validateInimg(i)?(t.prodPage.p=i,s.puPSearch(1,i),t.SRP.c++):s.sSrp())},useUserId:function(){},useUserData:function(t){var s=null;try{s=spsupport.p.$.parseJSON(t)}catch(i){s=null}s&&similarproducts.utilities.abTestUtil&&s.ut&&similarproducts.utilities.abTestUtil.setValues(s.ut)},gotMessage:function(t,s){if(!s||-1!=s.indexOf(similarproducts.b.sfDomain.split("/")[0])){if(t){t+="";var i=t.split(similarproducts.b.xdMsgDelimiter)}var e=spsupport.p,r,p=0;if(i&&i.length){var o=i.length>5?1:0;if(o&&e.prodPage.e)return;if(t=+i[0],t>3e3)return;var a=similarproducts.util,n=spsupport.api;if(-9741==t){var u=i[1];spsupport.p.userid=u,similarproducts.b.userid=u,e.userid=u,n.useUserId()}if(-9999==t&&window.location.reload(),-1e4==t){similarproducts.info.close();var c=spsupport.p.$(".similarProductsPluginWin10k").hide()}if(-1234==t&&(e.presFt=i[1]),-3333==t)n.useUserData(i[1]);else if(-7890==t){if(e.uninst=+i[2],e.uninstSu=+i[3],1==e.uninstSu&&(similarproducts.b.slideup=0,similarproducts.b.slideupSrp=0,similarproducts.b.slideupAndInimg=0),e.uninst)return void spsupport.api.killIcons();e.ifLoaded=1,e.vv=+i[1],e.vv||spsupport.checkAppVersion(spsupport.p.$,similarproducts.clientVersion,function(){},this,null,function(t){similarproducts.util.sendRequest('{"cmd": 9, "name": "'+t+'" }'),e.vv=1},e.userid,"initial",similarproducts.b.dlsource,spsupport.api.dtBr(),similarproducts.b.ip),0!=a.standByData&&(n.sTime(0),similarproducts.utilities.sfWatcher.setState("gotMessage sendRequest"),a.sendRequest(a.standByData),a.standByData=0),spsupport.statsREP.sendRequestCallback(),spsupport.statsREP.reportStats(spsupport.statsREP.repMode.awake)}else if(t>=200&&2e3>t){if(similarproducts.utilities.sfWatcher.setState("gotMessage param="+t),e.itemsNum=+i[1],e.tlsNum=+i[2],a.showContent(),n.sTime(1),i[6]&&similarproducts.inimg&&!similarproducts.inimg.hasTemplate()&&similarproducts.Template.initialize(i[6]),!o){if(similarproducts.inimg){similarproducts.inimg.setReload&&similarproducts.inimg.setReload();for(r in similarproducts.inimg.res)similarproducts.inimg.res[r]=0;spsupport.slideup&&(spsupport.slideup.res=0),221>t||(similarproducts.inimg.res[i[3]]=e.itemsNum,similarproducts.inimg.spl&&similarproducts.inimg.spl(i[3]),spsupport.slideup&&(spsupport.slideup.res=4))}a.currImg==e.sfIcon.ic.img&&e.sfIcon.ic.progress.e>0&&(e.before=0,222==t&&(similarproducts.b.slideup&&"SRP"!=e.pageType||similarproducts.b.slideupSrp&&"SRP"==e.pageType)&&(p=1),a.openPopup(e.imPos,e.appVersion,p))}if(e.before=0,200==t)o?!e.prodPage.e&&e.prodPage.s&&(similarproducts.b.inimgSrp&&0==e.prodPage.i?(e.prodPage.s=0,n.sSrp()):("2014w09_NoCouponWithInimg_A"==similarproducts.utilities.abTestUtil.getBucket()&&n.requestCouponsWl(),similarproducts.utilities.sfWatcher.setState("gotMessage param="+t+" no results"))):2!=similarproducts.p.onAir&&(a.currImg&&a.currImg.setAttribute("sfnoicon","1"),e.oopsTm=setTimeout(function(){a.closePopup()},3e3)),similarproducts.utilities.sfWatcher.complete("no results retuned");else if(t>200)if(similarproducts.b&&similarproducts.b.inimg&&o){if(similarproducts.utilities.sfWatcher.setState("gotMessage param="+t+" reuslts"),e.prodPage.s&&!e.prodPage.e&&(e.prodPage.e=1,similarproducts.utilities.sfWatcher.setState("gotMessage param="+t+" reuslts -show"),similarproducts.b.inimg&&similarproducts.inimg)){if(similarproducts.isAuto&&(similarproducts.autoSession=a.currentSessionId,a.openPopup(e.imPos,e.appVersion,0),similarproducts.util.sendRequest('{"cmd": 7 }'),0==similarproducts.inimg.itn&&(similarproducts.inimg.itn=1)),similarproducts.utilities.sfWatcher.setState("gotMessage param="+t+" reuslts - inimg/slideup"),similarproducts.b.slideup&&"SRP"!=e.pageType||similarproducts.b.slideupSrp&&"SRP"==e.pageType){similarproducts.utilities.sfWatcher.setState("gotMessage param="+t+" reuslts slideup"),spsupport.slideup.init(i[3],a,spsupport.p,similarproducts.b,e.prodPage.p);var l=+i[4];similarproducts.b.slideupAndInimg&&similarproducts.inimg.itNum[l]>0&&similarproducts.inimg.init(i[3],l,a,spsupport.p,similarproducts.b,e.prodPage.p)}else similarproducts.utilities.sfWatcher.setState("gotMessage param="+t+" reuslts image"),similarproducts.inimg.init(i[3],+i[4],a,spsupport.p,similarproducts.b,e.prodPage.p);n.fixDivsPos(),similarproducts.b.inimgSrp&&0==e.prodPage.i&&(e.prodPage.s=0,e.prodPage.e=0,n.sSrp())}}else 211==t&&similarproducts.utilities.sfWatcher.complete("search popup")}else t>2001?i[3]&&(e.before=0,similarproducts.sg.init(i[3]),a.closePopup(),"2014w13_Localv2_SeeMoreButton_EbayInImgSerget_Holdback"!=similarproducts.utilities.abTestUtil.getBucket()&&e.sgDualResults&&e.prodPage.p&&(i[6]&&!similarproducts.inimg.hasTemplate()&&similarproducts.Template.initialize(i[6]),similarproducts.inimg.init(i[3],+i[4],a,spsupport.p,similarproducts.b,e.prodPage.p),n.fixIiPos()),n.fixDivsPos()):20==t?a.closePopup():40==t?e.prodPage.p.sfwakeup=i[1]:60==t?similarproducts.info.ev():-3219==t?(similarproducts.dataApi.init(similarproducts.b.pluginDomain,similarproducts.b.userid,similarproducts.b.dlsource,spsupport.api.dtBr()),similarproducts.dataApi.setSearchResult(spsupport.p.$.parseJSON(i[1]))):-3218==t&&(similarproducts.b.uc=i[1])}}},onJqLoad:function(t){var s=spsupport.p;if(s.wnd.$){var i,e=s.wnd.$(window.document);i=s.wnd.$.fn.init,s.wnd.$.fn.init=function(t,s,r){return s=s||e||window.document,new i(t,s,r)},s.wnd.$.expr[":"].regex=function(t,i,e){var r=e[3].split(","),p=/^(data|css):/,o={method:r[0].match(p)?r[0].split(":")[0]:"attr",property:r.shift().replace(p,"")},a="ig",n=new RegExp(r.join("").replace(/^\s+|\s+$/g,""),a);return n.test(s.wnd.$(t)[o.method](o.property))},s.$=s.wnd.$,spsupport.api.jQLoaded()}else setTimeout(function(){50>t&&spsupport.api.onJqLoad(t+1)},50+10*t)},jQLoaded:function(){var t=spsupport.p;if(t.isIE=t.$.browser?t.$.browser.msie:0,t.isFF=t.$.browser?t.$.browser.mozilla:0,t.isIE7=t.isIE&&7===parseInt(t.$.browser.version,10),t.isIE8=t.isIE&&8===parseInt(t.$.browser.version,10),similarproducts.b.userLang=similarproducts.b.qsObj&&similarproducts.b.qsObj.language||window.navigator.language||window.navigator.userLanguage||"en",similarproducts.b.userLang=similarproducts.b.userLang.toLowerCase(),similarproducts.b.userData.userLang=similarproducts.b.userLang,similarproducts.b.userData.lang=similarproducts.b.userLang.split("-")[0],similarproducts.languages&&similarproducts.languages[similarproducts.b.userData.lang]&&"2014w13_Localv2_SeeMoreButton_EbayInImgSerget_Holdback"!=similarproducts.utilities.abTestUtil.getBucket()||(similarproducts.b.userData.lang="en"),!spsupport.sites.isBlackStage()){spsupport.sites.searchget(),spsupport.whiteStage&&spsupport.whiteStage.init&&spsupport.whiteStage.init(spsupport.p.$),similarproducts.utilities.sfWatcher.setState("user init"),spsupport.api.userIdInit(),t.isIE&&window.spMsiSupport&&(this.isOlderVersion("1.2.1.0",t.clientVersion)||spMsiSupport.validateUpdate(),t.isIE7&&(t.isIEQ=1)),(spsupport.p.$("#BesttoolbarsChromeToolbar").length||spsupport.p.$("#main-iframe-wrapper").length)&&"ch"==spsupport.api.dtBr()&&(t.applTb=1,applTbVal=spsupport.p.$("#main-iframe-wrapper").height()||spsupport.p.$("#BesttoolbarsChromeToolbar").height()),spsupport.p.$(".bt-btpersonas-toolbar").length&&"ch"==spsupport.api.dtBr()&&(t.applTb=1,applTbVal=spsupport.p.$(".bt-btpersonas-toolbar").height());var s=similarproducts.utilities.abTestUtil.getBucket();"2014w13_New_Hover"==s||"2014w13_New_Hover_and_Remove_Store"==s||"2014w13_Old_Hover_and_Remove_Store"==s||"uiRedesign01LT_A"==s||"uiRedesign01LT_B"==s?similarproducts.b.inj(document,t.sfDomain+"css/main_test.css?v="+similarproducts.b.appVersion):similarproducts.b.inj(document,spsupport.p.sfDomain+"css/main.css?v="+similarproducts.b.appVersion),function(t){function s(s){var i=s||window.event,e=[].slice.call(arguments,1),r=0,p=!0,o=0,a=0;return s=t.event.fix(i),s.type="mousewheel",i.wheelDelta&&(r=i.wheelDelta/120),i.detail&&(r=-i.detail/3),a=r,void 0!==i.axis&&i.axis===i.HORIZONTAL_AXIS&&(a=0,o=-1*r),void 0!==i.wheelDeltaY&&(a=i.wheelDeltaY/120),void 0!==i.wheelDeltaX&&(o=-1*i.wheelDeltaX/120),e.unshift(s,r,o,a),(t.event.dispatch||t.event.handle).apply(this,e)}var i=["wheel","mousewheel"];if(t.event.fixHooks)for(var e=i.length;e;)t.event.fixHooks[i[--e]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=i.length;t;)this.addEventListener(i[--t],s,!1);else this.onmousewheel=s},teardown:function(){if(this.removeEventListener)for(var t=i.length;t;)this.removeEventListener(i[--t],s,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}(spsupport.p.$),setTimeout(function(){spsupport.sites.care(),spsupport.sites.urlChange()},1),setTimeout(function(){t.$(window).unload(function(){similarproducts.p&&similarproducts.p.onAir&&similarproducts.util.bCloseEvent(t.$("#SF_CloseButton")[0],2)})},2e3)}},userIdInit:function(){var t=spsupport.p,s=spsupport.api,i={dlsource:t.dlsource};""!=t.w3iAFS&&(i.w3iAFS=t.w3iAFS),""!=t.CD_CTID&&(i.CD_CTID=t.CD_CTID),""!=t.userid&&void 0!=t.userid?s.onUserInitOK({userId:t.userid,statsReporter:t.statsReporter}):s.jsonpRequest(t.sfDomain_+"initUserJsonp.action",i,s.onUserInitOK,s.onUserInitFail,"similarproductsInitUserCallbackfunc")},onUserInitOK:function(t){var s=spsupport.api,i=spsupport.p;t&&t.userId&&""!=t.userId?(i.userid=t.userId,similarproducts.utilities.sfWatcher.setUserid(i.userid),i.statsReporter=t.statsReporter,spsupport.p.blSite?spsupport.api.requestCouponsWl():s.isURISupported(document.location)):s.onUserInitFail()},isURISupported:function(){var t=spsupport.api;spsupport.p.merchantName="";var s=similarproducts.b.wlVersion;similarproducts.utilities&&(s=similarproducts.utilities.versionManager.useNewVer(100,similarproducts.b.wlStartDate,similarproducts.b.wlDestDate)?similarproducts.b.wlVersion:similarproducts.b.wlOldVersion);var i=spsupport.p.sfDomain_;spsupport.p.sfDomain_.indexOf("localhost")>-1&&(i="http://www.best-deals-products.com/ws/"),t.jsonpRequest(i+"getSupportedSitesJSON.action?ver="+s,0,t.isURISupportedCB,t.isURISupportedFail,"SF_isURISupported")},injCpn:function(t){var s=spsupport.p,i;switch(t){case 1:i="wl";break;case 2:i="cwl";break;case 3:i="blws";break;case 4:i="pip";break;case 5:i="st";break;case 6:i="cpip";break;default:i="na"}if(s.iCpn=1,4!=t&&5!=t&&(6!=t||similarproducts.b.dlsrcEnableCpnPip)){var e=similarproducts.b.site;spsupport.api.initMessanger(),e+=similarproducts.utilities.abTestUtil&&"2014w07_NewCouponInfrastructure_A"==similarproducts.utilities.abTestUtil.getBucket()?"coupons-new/index.jsp?dlSource="+s.dlsource+"&subDlSource="+s.CD_CTID+"&userId="+s.userid+"&siteType="+i+"&pageType="+s.pageType+"&v="+s.appVersion:similarproducts.b.cacheBySubDlsource&&s.CD_CTID?"coupons/get.jsp?pi="+s.dlsource+"&psi="+s.CD_CTID+"&mc="+s.CD_CTID+"&ui="+s.userid+"&st="+i+(similarproducts.b.CD_CTID?"&cc="+similarproducts.b.CD_CTID:"")+"&v="+s.appVersion:"coupons/get.jsp?pi="+s.dlsource+"&psi="+s.CD_CTID+"&ui="+s.userid+"&st="+i+(similarproducts.b.CD_CTID?"&cc="+similarproducts.b.CD_CTID:"")+"&v="+s.appVersion,"sfrvzr"==similarproducts.b.dlsource?spsupport.p.$.ajax({url:similarproducts.b.pluginDomain+"hc/app/config/hc-white-list.js",data:{v:spsupport.p.appVersion},jsonpCallback:"SF_hcWlCb",dataType:"jsonp",success:function(t){var r=similarproducts.b.userData.uc.toLowerCase(),p=spsupport.api.getDomain().toLowerCase(),o=t.data&&t.data[r]&&t.data[r].sites||[],a=[];if(o.indexOf)a=o;else for(var n=0,u=o.length;u>n;n++)a.push(o[n]);a.indexOf&&a.indexOf(p)>-1?similarproducts.b.inj(window.document,similarproducts.b.site+"hc/index.jsp?dlSource="+s.dlsource+"&subDlSource="+s.CD_CTID+"&userId="+s.userid+"&siteType="+i+"&v="+s.appVersion,1):similarproducts.b.inj(window.document,e,1)}}):similarproducts.b.inj(window.document,e,1)}},isURISupportedCB:function(t){spsupport.p.$(document).ready(function(){spsupport.api.onDocumentLoaded(t)})},onDocumentLoaded:function(t){similarproducts.utilities.sfWatcher.setState("isURISupportedCB");var s=spsupport.api,i=spsupport.p,e=similarproducts.b,r=spsupport.whiteStage;i.totalItemCount=t.totalItemCount;var p=s.getDomain();e.sm&&"google.com"!=p&&(e.icons=0,e.inimg=0,e.inimgSrp=0,e.ignoreWL=0,e.stDt=0,e.topPpc=0,e.rvDt=0,e.inImgDt=0),e.slideup&&(e.inimg=1),e.slideupSrp&&(e.inimgSrp=1),spsupport.txtSr&&spsupport.txtSr.dt&&(spsupport.txtSr.wl=t,spsupport.txtSr.dt.sendLate||spsupport.txtSr.useWl());var o=p.toLowerCase().split("."),a;-1==r.bl.indexOf(o[0]+".")&&(a=t.supportedSitesMap[p]),!a&&spsupport.txtSr&&spsupport.txtSr.dt&&(a=spsupport.txtSr.siteInfo(p)),similarproducts.partner.init(),similarproducts.publisher.init(),a?i.supportedSite=1:(e.ignoreWL||(r.st=e.stDt?r.isStore():0),(e.ignoreWL||r.st)&&(a=s.getSiteInfo(),r.st&&(i.prodPage.d=140,i.prodPage.l=1100,similarproducts.b.inimgSrp=0))),a&&!s.isBLSite(t)?(e.topPpc&&!i.iTpc&&(i.iTpc=1,spsupport.sites.topPpc(a)),similarproducts.utilities.sfWatcher.setState("Start store"),s.injectIcons(a)):(similarproducts.b.inImgDt&&(r.isProductInPage()?(similarproducts.utilities.sfWatcher.setState("start pip"),s.pipDetected()):(similarproducts.utilities.sfWatcher.complete("not supported site type"),"function"==typeof window.similarProductsNoSearch&&window.similarProductsNoSearch('{"message":"is not supported site type"}'))),i.icons||setTimeout(s.saveStatistics,400));var n=similarproducts.sg?similarproducts.sg.sSite:0;0==e.inimgSrp&&"PP"!=i.pageType&&0==n&&(similarproducts.utilities.sfWatcher.complete("no Inimage in SRP"),"function"==typeof window.similarProductsNoSearch&&window.similarProductsNoSearch('{"message":"no Inimage in SRP"}')),0==e.inimg&&"PP"==i.pageType&&0==n&&(similarproducts.utilities.sfWatcher.complete("no Inimage PP"),"function"==typeof window.similarProductsNoSearch&&window.similarProductsNoSearch('{"message":"no Inimage PP"}')),(e.inimg&&"PP"==i.pageType&&0==n||e.inimgSrp&&"PP"!=i.pageType&&0==n)&&("wl"==i.siteType||"st"==i.siteType||"pip"==i.siteType)&&i.prodPage.p&&"2014w09_NoCouponWithInimg_A"==similarproducts.utilities.abTestUtil.getBucket()||s.requestCouponsWl(),s.documentHeight=i.$(document).height()},requestCouponsWl:function(){var t=spsupport.api,s=similarproducts.b;if(s.cpn[0]&&!spsupport.p.iCpnWl){spsupport.p.iCpnWl=1;var i=similarproducts.b.cpnVersion;similarproducts.utilities&&(i=similarproducts.utilities.versionManager.useNewVer(100,similarproducts.b.cpnStartDate,similarproducts.b.cpnDestDate)?similarproducts.b.cpnVersion:similarproducts.b.cpnOldVersion);var e=spsupport.p.sfDomain_;spsupport.p.sfDomain_.indexOf("localhost")>-1&&(e="http://www.best-deals-products.com/ws/"),t.jsonpRequest(e+"getCouponsSupportedSites.action?ver="+i,0,t.cpnWlCB,t.cpnWlFail,s.cpnWLcb)}},pipDetected:function(){var t=spsupport.api,s=similarproducts.b;s.icons=0;var i=t.getSiteInfo();spsupport.p.pipFlow=1,spsupport.pip.start(i)},getRandomInt:function(t,s){return Math.floor(Math.random()*(s-t+1))+t},getSiteInfo:function(){var t={};return t.imageURLPrefixes="",t.merchantName=spsupport.p.siteDomain,t},cpnWlCB:function(t){var s=spsupport.p;if(!s.iCpn){var e=document.location.host.toLowerCase(),r=e.replace(/[^.]/g,"").length,p=!1;for(t.a=","+t.a+",",i=0;r>i;i++)-1!=t.a.indexOf(","+e+",")&&(p=!0),e=e.substring(e.indexOf(".")+1,e.length);if(!p){var o=spsupport.p.siteDomain.split(".")[0];spsupport.whiteStage&&spsupport.whiteStage.bl.indexOf(o)>-1&&(p=!0)}p?spsupport.api.injCpn(2):spsupport.api.cpnInjectRest()}},cpnWlFail:function(t){spsupport.api.cpnInjectRest()},cpnInjectRest:function(){var t=spsupport.api,s=similarproducts.b,i=spsupport.p,e=spsupport.whiteStage;if(s.cpn[0]&&!i.iCpn){var r=-1;r="pip"==e.st?4:"st"==e.st?5:6,t.injCpn(r)}},isURISupportedFail:function(t){},isBLSite:function(t){var s=0;if(t.blockedSubDomains)for(var i=0;i<t.blockedSubDomains.length&&!s;i++){var e=top.location+"";e.indexOf(t.blockedSubDomains[i])>=0&&(s=1)}return s},injectIcons:function(t){spsupport.p.supportedImageURLs=t.imageURLPrefixes,spsupport.p.merchantName=t.merchantName,spsupport.events.reportEvent("inject-icons","info"),spsupport.api.siteType(),spsupport.statsREP.init(),spsupport.sites.firstTimeRep(),spsupport.sites.preInject(),spsupport.api.careIcons(0)},initMessanger:function(){spsupport.p.messangerInitialized||(spsupport.p.messangerInitialized=1,similarproducts.b.xdmsg.init(spsupport.api.gotMessage,spsupport.p.isIE7?200:0))},addSimilarProductsSupport:function(){spsupport.api.initMessanger(),top.similarproductsMng||(top.similarproductsMng={}),top.similarproducts||(top.similarproducts={}),top.similarproducts.p||(top.similarproducts.p={site:spsupport.p.site,totalItemsCount:spsupport.p.totalItemCount,cdnUrl:spsupport.p.cdnUrl,appVersion:spsupport.p.appVersion}),top.similarproducts.util||spsupport.p.iSf?(similarproducts.utilities.sfWatcher.complete("no inimage at all"),"function"==typeof window.similarProductsNoSearch&&window.similarProductsNoSearch('{"message":"no inimage at all"}')):(spsupport.p.iSf=1,"uiRedesign01LT_A"==similarproducts.utilities.abTestUtil.getBucket()||"uiRedesign01LT_B"==similarproducts.utilities.abTestUtil.getBucket()?similarproducts.b.inj(window.document,similarproducts.b.site+"js/sf_allenby_redesign.js?version="+spsupport.p.appVersion,1):similarproducts.b.inj(window.document,similarproducts.b.site+"js/sf_allenby.js?version="+spsupport.p.appVersion,1))},careIcons:function(t){var s=spsupport.p,i=spsupport.api,e=s.$(document),r=s.$(window),p,o;if(similarproducts.utilities.sfWatcher.setState("careIcons"),s.icons=this.startDOMEnumeration(),window.conduitToolbarCB&&s.icons>0&&spsupport.isShowConduitWinFirstTimeIcons&&conduitToolbarCB("openPageForFirstTimeIcons"),s.icons>0||spsupport.sites.ph2bi()){i.addSimilarProductsSupport(),r.focus(function(){s.onFocus=1,i.startDOMEnumeration()}).resize(function(){i.fixDivsPos(),i.fixIiPos()}).scroll(function(){var t=e.height();t!=spsupport.api.documentHeight&&(spsupport.api.documentHeight=t,spsupport.api.addAdditionalImages())}).unload(i.unloadEvent);var a=function(t){p=e.width(),o=e.height(),setTimeout(function(){o===e.height()&&p===e.width()?t&&i.startDOMEnumeration():a(!0)},250)};e.click(function(t){"a"===t.target.nodeName.toLowerCase()&&a()}),i.vMEvent(),e.ready(function(){setTimeout(function(){i.wRefresh(1300),i.saveStatistics()},spsupport.sites.gRD())})}else 7==t?spsupport.api.saveStatistics():setTimeout(function(){spsupport.api.careIcons(++t)},1300+400*t)},siteType:function(){var t=spsupport.p,s=spsupport.whiteStage;t.siteType||(t.siteType=t.supportedSite?"wl":s.st?"st":s.pip?"pip":similarproducts.b.ignoreWL?"ign":"other")},vMEvent:function(){try{if(window.similarproducts&&window.similarproducts.util){var t=similarproducts.util.bubble();if(t)return void spsupport.domHelper.addEListener(t,spsupport.api.blockDOMSubtreeModified,"DOMSubtreeModified")}}catch(s){}setTimeout("spsupport.api.vMEvent()",500)},puPSearch:function(t,s){if(101>t){var i=spsupport.p,e=similarproducts.sg,r=similarproducts.inimg;(similarproducts.b.inimg||e&&e.sSite)&&(i.prodPage.s<2||similarproducts.p&&1==similarproducts.p.onAir)&&setTimeout(function(){var p=similarproducts.util;if(p){if(i.prodPage.s<2&&!i.prodPage.e){var o=spsupport.api.getItemPos(s);spsupport.p.imPos=o;var a,n=e?e.sSite:0,u=similarproducts.b.inimg&&r&&!n?r.vi(o.w,o.h):0,c=u;u=spsupport.api.careIi(u,1);var l=r?r.iiInd:0;r&&(r.itNum[l]=Math.min(u,c));var d=1;if(a=spsupport.api.getItemJSON(s),similarproducts.b.slideup&&(u=Math.max(u,4)),!n&&0==u)return;p.prepareData(a,1,n,d,u,l,0,0,spsupport.p.$(s).outerWidth(),spsupport.p.$(s).outerHeight()),p.openPopup(o,i.appVersion,1,1),p.lastAIcon.x=o.x,p.lastAIcon.y=o.y,p.lastAIcon.w=o.w,p.lastAIcon.h=o.h,p.lastAIcon.img=s,i.prodPage.s=2}}else setTimeout(function(){spsupport.api.puPSearch(t+1,s)},100)},30)}},onDOMSubtreeModified:function(t){var s=spsupport.api;s.killIcons(),s.DOMSubtreeTimer&&clearTimeout(s.DOMSubtreeTimer),s.DOMSubtreeTimer=setTimeout(spsupport.api.onDOMSubtreeModifiedTimeout,1e3)},onDOMSubtreeModifiedTimeout:function(){clearTimeout(spsupport.api.DOMSubtreeTimer),spsupport.api.startDOMEnumeration()},blockDOMSubtreeModified:function(t,s){t.stopPropagation()},loadIcons:function(){var t=similarproducts.b.userLang&&similarproducts.b.userLang.split("-")[0]||"en";spsupport.p.sfIcon.labels=t&&similarproducts.languages[t]&&similarproducts.languages[t].buttons||similarproducts.languages.en.buttons},killIcons:function(){this.dettachDocumentEvents()},fixDivsPos:function(){for(var t,s,i=spsupport.p,e=0,r=i.activeAreas.length;r>e;e++)t=i.activeAreas[e][4],t&&(s=spsupport.api.getImagePosition(t),i.activeAreas[e]=[s.x,s.y,s.x+t.width,s.y+t.height,t])},fixIiPos:function(){similarproducts.inimg&&similarproducts.inimg.fixPosition()&&similarproducts.inimg.fixPosition()},startDOMEnumeration:function(){var t=spsupport.api,s=spsupport.sites,i=spsupport.p,e=similarproducts.b,r=0;if(document.body){if(1==i.uninst||spsupport.p.pipFlow)return 1==i.uninst&&(similarproducts.utilities.sfWatcher.complete("startDOMEnumeration - uninstall"),"function"==typeof window.similarProductsNoSearch&&"undefined"==typeof i.similarProductsNoSearch&&(i.similarProductsNoSearch=!0,window.similarProductsNoSearch('{"message":"startDOMEnumeration - uninstall"}'))),0;if(i.SRP.p=[],s.validRefState()){if(e.icons&&!i.$("#sfButtons").length)var p=i.$("<span/>",{id:"sfButtons"}).appendTo(document.body)[0];var o=s.gVI()||document.images,a=0,n;i.activeAreas=[],t.attachDocumentEvents();for(var u=0,c=o.length;c>u;u++)if(a=t.isImageSupported(o[u])){if(o[u].setAttribute("sf_validated",1),e.icons&&(r||(t.addAn(),t.loadIcons(),i.sfIcon.ic||t.addSeeMoreButton()),similarproducts.b.multipleIcons&&t.addSFButton(p,o[u]),t.addSFDiv(o[u])),n=o[u].getAttribute("nosureq"),"1"!=n){if(!e.multiImg){var l=t.getImagePosition(o[u]),d=t.validateSU(o[u],parseInt(l.y+o[u].height-45));d||i.prodPage.i||(i.SRP.p[i.SRP.p.length]=o[u],i.SRP.i++)}similarproducts.publisher.pushImg(o[u])}r++}else o[u].getAttribute("sf_validated")||o[u].getAttribute("sfimgevt")||(o[u].onload=t.onLoadImage.bind(this,o[u]));similarproducts.b.inimgSrp&&spsupport.sites.su()&&(!i.prodPage.p&&!i.prodPage.s||spsupport.sites.isSrp())&&i.SRP.p.length&&(similarproducts.sg&&(similarproducts.sg.sSite=0),i.SRP.lim=similarproducts.b.inimgSrp?similarproducts.b.inimgSrp:0,i.SRP.lim=Math.min(i.SRP.lim,i.SRP.p.length),t.sSrp()),r>0?setTimeout(function(){spsupport.p.statSent||(t.saveStatistics(),spsupport.p.statSent=1)},700):spsupport.txtSr&&spsupport.txtSr.dt?s.txtSrch():"st"==i.siteType?t.pipDetected():(similarproducts.utilities.sfWatcher.complete("no good images"),"function"==typeof window.similarProductsNoSearch&&"undefined"==typeof i.similarProductsNoSearch&&(i.similarProductsNoSearch=!0,window.similarProductsNoSearch('{"message":"no good images"}')))}return r}},addAdditionalImages:function(){var t=spsupport.api,s=spsupport.sites.gVI()||document.images,i;if(document.body)for(var e=0,r=s.length;r>e;e++)i=s[e],i.getAttribute("sf_validated")||i.getAttribute("sfimgevt")||(t.onLoadImage(i),i.onload=t.onLoadImage.bind(this,i))},onLoadImage:function(t){var s=spsupport.api,i=spsupport.p;if(s.isImageSupported(t)&&(t.setAttribute("sf_validated",1),s.addSFDiv(t),!similarproducts.b.multiImg&&"1"!=t.getAttribute("nosureq"))){var e=s.getImagePosition(t),r=s.validateSU(t,parseInt(e.y+t.height-45));r||i.prodPage.i||(i.SRP.p[i.SRP.p.length]=t,i.SRP.i++)}},attachDocumentEvents:function(){var t=spsupport.p,s=t.$(document);s.off({mousemove:this.onMouseMove,mousewheel:this.onMouseMove}),s.on({mousemove:this.onMouseMove,mousewheel:this.onMouseMove})},dettachDocumentEvents:function(){var t=spsupport.p,s=t.$(document);s.off({mousemove:this.onMouseMove,mousewheel:this.onMouseMove})},onMouseMove:function(t){for(var s=spsupport.p,i=s.activeAreas,e=t.pageX,r=t.pageY,p=!1,o,a,n=0,u=i.length;u>n;n++)if(o=i[n],e>=o[0]&&r>=o[1]&&e<=o[2]&&r<=o[3]){p=!0,a=o[4],a!=s.currentImage&&(spsupport.api.positionSFDiv(a,o),s.currentImage=a,s.sfIcon.ic.img=a);break}!p&&s.currentImage&&(s.currentImage=null,s.sfIcon.ic.css({left:-200,top:-200}))},imageSupported:function(t){if(-1!=t.search(/videos|maps\.google/i))return 0;try{var s=spsupport.p.supportedImageURLs;if(0==s.length)return 1;for(var i=0;i<s.length;i++)if(t.indexOf(s[i])>-1)return 1}catch(e){return 0}return 0},isImageSupported:function(t){var s=spsupport.p,i=+t.getAttribute(s.sfIcon.evl);if(-1==i)return 0;if(1==i)return 1;var e="";try{e=t.src.toLowerCase()}catch(r){return 0}var p=e.indexOf("?");
if(-1!=p&&(e=e.substring(0,p)),e.length<4)return 0;var o=e.substring(e.length-4,e.length);if(".gif"==o||".png"==o)return 0;var a=t.width,n=t.height;if(a*n<s.minImageArea)return 0;if(!spsupport.whiteStage.pip){var u=a/n;if(a*n>2*s.minImageArea&&(u<s.aspectRatio||u>2.5))return 0}return t.getAttribute("usemap")?0:this.imageSupported(t.src)?spsupport.api.isVisible(t)?spsupport.api.isViewable(t)?spsupport.api.isInScreen(t)?spsupport.sites.imgSupported(t)?a<=s.sfIcon.maxSmImg.w||n<=s.sfIcon.maxSmImg.h?2:1:0:0:0:0:0},wRefresh:function(t){setTimeout(function(){spsupport.api.startDOMEnumeration()},2*t)},isViewable:function(t){var s=spsupport.api.overflowParent(t.parentNode);if(s){var i=spsupport.api.getItemPos(t),e=spsupport.api.getItemPos(s);if(i.x>=e.x+e.w||i.y>=e.y+e.h)return 0;if(i.x+i.w<=e.x||i.y+i.h<=e.y)return 0}return 1},isInScreen:function(t){var s=spsupport.api.getItemPos(t),i=20;return s.x<0||s.y<10||s.x+s.w-i<0||s.x+i>window.innerWidth?0:1},overflowParent:function(t){return t&&t.parentNode&&t!=document?(t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth)&&"hidden"===spsupport.p.$(t).css("overflow")&&"visible"===spsupport.p.$(t.parentNode).css("overflow")?t:spsupport.api.overflowParent(t.parentNode):0},isVisible:function(t){var s=t.offsetWidth,i=t.offsetHeight;return!(0===s&&0===i||!spsupport.p.$.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||spsupport.p.$.css(t,"display"))||"hidden"===(t.style&&t.style.visibility||spsupport.p.$.css(t,"visibility")))},sfIPath:function(t){var s=spsupport.p,i=2==t?2:0;return{r:s.sfIcon.icons[i].src,o:s.sfIcon.icons[i+1].src}},getSrUrl:function(t,s){var i=this,e=similarproducts.util,r=spsupport.p,p=similarproducts.b.lp?"findByUrlLanding.action":"findByUrlSfsrp.action",o=0,a=window.location.href,n;if(a.indexOf(p)>-1){o=1;for(var u=a.split("&"),c=1;c<u.length;c++)if(u[c].indexOf("sessionid")>-1){n=u[c].split("=")[1];break}}var l=i.getItemJSON(t.img),d=spsupport.p.siteType,m=similarproducts.p.site+p+"?";return m=m+"userid="+decodeURIComponent(l.userid)+"&sessionid="+e.getUniqueId()+"&dlsource="+r.dlsource+(""!=r.CD_CTID?"&CD_CTID="+r.CD_CTID:"")+"&merchantName="+l.merchantName+"&imageURL="+l.imageURL.replace(/&/g,similarproducts.b.urlDel)+"&imageTitle="+l.imageTitle+"&imageRelatedText="+l.imageRelatedText+(spsupport.whiteStage&&spsupport.whiteStage.matchedBrand?spsupport.whiteStage.matchedBrand:"")+"&documentTitle="+l.documentTitle+"&productUrl="+l.productUrl+(l.pr?"&pr="+l.pr:"")+"&slideUp="+s+"&ii=0&identical=0&pageType="+r.pageType+"&siteType="+d+(spsupport.p.isIE7||o?"":"&pageUrl="+a)+"&ip="+similarproducts.b.ip+(n?"&origSessionId="+n:"")+(similarproducts.b.tg&&""!=similarproducts.b.tg?"&tg="+similarproducts.b.tg:"")+"&br="+i.dtBr()},osr:function(t,s){window.location.href=spsupport.api.getSrUrl(t,s)},goSend:function(t,s){var i=similarproducts.util,e=this,r=spsupport.p,p=s.img;i?(r.imPos=e.getItemPos(p),(1==t||2==t)&&i.currImg!=p&&(i.currImg=p,similarproducts.p.onAir&&i.closePopup(),i.prepareData(e.getItemJSON(p),0,0,0,0,0,0,0,p.width,p.height),s.sent=1,clearTimeout(r.iconTm),clearTimeout(r.oopsTm),r.prodPage.e=1),(1==t||3==t)&&(similarproducts.utilities.sfWatcher.reset(),similarproducts.utilities.sfWatcher.setState("manual Search "+t),e.resetPBar(s),r.sfIcon.ic.progress.e=2,i.currImg==p&&0==r.before&&(i.openPopup(r.imPos,r.appVersion,0),similarproducts.utilities.sfWatcher.complete("search same item")))):setTimeout(function(){spsupport.api.goSend(t,s)},400)},resetPBar:function(t){var s=spsupport.p;s.sfIcon.ic.progress.stop(),s.sfIcon.ic.progress.css({width:0}),t.sent=0},hdIcon:function(){var t=spsupport.p;t.sfIcon.ic.css({top:-200})},addSeeMoreButton:function(){var t=spsupport.p,s=spsupport.api,i=spsupport.sites.rules(),e=i&&i.getZIndex&&i.getZIndex()||32005,r=t.$("<div/>",{"class":"__similarproducts see_more_button",id:"sf_see_similar"}),p=t.$("<div/>",{"class":"button_label"}),o=t.$("<div/>",{"class":"button_progress",id:"sfIconProgressBar"});o.e=0,r.append(p,o),r.css({zIndex:e}),r.label=p,r.progress=o,similarproducts.b.buttonsTest||r.addClass("orange"),r.mouseenter(function(i){i.relatedTarget!=o[0]&&(o.e=1,r.addClass("hovered"),s.setButtonLabel(!0),o.animate({width:"100%"},{duration:1e3,complete:function(){similarproducts.b.lp?s.osr(r,0):s.goSend(3,r)}}),t.sfIcon.timer=setTimeout(function(){s.goSend(2,r)},250),similarproducts.util&&(similarproducts.util.hideLaser(),similarproducts.util.showLaser(s.getItemPos(r.img))))}),r.mouseleave(function(i){i.relatedTarget!=o[0]&&(o.e=2==o.e?2:0,r.removeClass("hovered"),s.setButtonLabel(!1),t.sfIcon.timer&&clearTimeout(t.sfIcon.timer),s.resetPBar(this),0==o.e&&(similarproducts.util?similarproducts.util.hideLaser():t.sfIcon.an&&t.sfIcon.an.css({left:-2e3,top:-2e3})),2==t.before&&similarproducts.util&&similarproducts.util.reportClose())}),r.click(function(t){t&&2==t.button||r.img&&(similarproducts.b.lp?s.osr(r,0):s.goSend(1,r))}),t.sfIcon.ic=r,r.appendTo(document.body)},setButtonLabel:function(t){var s=spsupport.p,i=s.sfIcon.ic,e=s.sfIcon.labels,r;r=i.hasClass("small")?t?e.smallOpening:e.small:t?e.bigOpening:e.big,i.label.html(r)},addAn:function(){var t=spsupport.p,s=spsupport.sites.rules(),i=s&&s.getZIndex&&s.getZIndex()||32005;t.sfIcon.an||(t.sfIcon.an=t.$("<div/>",{id:"sfImgAnalyzer"}),"2014w13_Localv2_SeeMoreButton_EbayInImgSerget_Holdback"==similarproducts.utilities.abTestUtil.getBucket()&&(similarproducts.b.buttonsTest=!0),similarproducts.b.buttonsTest?t.sfIcon.an.css({position:"absolute",overflow:"hidden",width:24,height:100,zIndex:i,top:-200,left:-200,background:"url("+t.imgPath+"scan.png) repeat-y"}):(t.sfIcon.an.addClass("circle_anim"),t.sfIcon.an.css({zIndex:i}),t.sfIcon.an.append(t.$("<div />"))),t.sfIcon.an.appendTo(document.body))},positionSFDiv:function(t,s){var i=spsupport.p,e=i.sfIcon,r=e.ic,p=s&&s.length>2?s[2]-s[0]:t.width,o=s&&s.length>3?s[3]-s[1]:t.height,a;p<=e.maxSmImg.w||o<=e.maxSmImg.h?r.addClass("small"):r.removeClass("small"),a=spsupport.api.calcIconPos(t,r,s),t.getAttribute("has_inimg")&&(a.t-=12,"trusty"===similarproducts.inimg.getDisplayMode()&&(a.t-=80)),r.html(spsupport.api.setButtonLabel(!1));var n,u,c;similarproducts.b.buttonsTest?r.css({left:a.l,top:a.t}):(a=spsupport.api.getImagePosition(t),n=11,u=18,c=10,a.h<=150&&(n=Math.round(a.h/100*8)-2,u=Math.max(14,Math.round(a.h/100*12)),c=Math.round(a.h/100*7)-2,i.$(".button_label",r).css({paddingTop:n,paddingBottom:n,fontSize:u})),r.css({left:a.x+(p-r.width())/2,top:a.y+o-(r.height()+c)}))},calcIconPos:function(t,s,i){var e,r,p,o,a={l:0,t:0};return i?(e=i[0],p=i[3],r=i[2]-i[0]):(o=spsupport.api.getImagePosition(t),e=o.x,p=o.y+t.height,r=t.width),a.l=r>190?e+1:e+(r-s.width())/2,a.t=p-28,a},addSFButton:function(t,s){},addSFDiv:function(t){var s=spsupport.p,i=spsupport.api.getImagePosition(t),e=spsupport.sites.rules();if(e&&e.checkIsGoodImage){if(!e.checkIsGoodImage(t,i))return}else if(t.width>s.picMaxWidth||t.height>s.picMaxWidth||i.x<0||i.y<10)return;s.activeAreas.push([i.x,i.y,i.x+t.width,i.y+t.height,t])},validateInimg:function(t){var s=similarproducts.inimg,i=similarproducts.sg,e=i?i.sSite:0;if(e||similarproducts.b.slideup&&"SRP"!=spsupport.p.pageType||similarproducts.b.slideupSrp&&"SRP"==spsupport.p.pageType)return 1;var r=spsupport.api.getItemPos(t),p=similarproducts.b.inimg&&s?s.vi(r.w,r.h):0;return p=spsupport.api.careIi(p,1),0==p&&similarproducts.isAuto&&(p=2),p},careIi:function(t,s){return 1==s&&"amazon"==spsupport.p.siteDomain.split(".")[0]&&(s=2),t="wl"==spsupport.p.siteType&&t>8?1==s?0:6:t,t=t>6?6:t,t=t>1?t:0,(similarproducts.b.slideup&&"SRP"!=spsupport.p.pageType||similarproducts.b.slideupSrp&&"SRP"==spsupport.p.pageType)&&(similarproducts.b.slideupAndInimg?t=Math.max(t,4):similarproducts.inimg.itn=t=4),t},validateSU:function(t,s){var i=spsupport.p,e=similarproducts.b.inimg?parseInt(s)>0:!0,r=t.width>i.prodPage.d&&t.height>i.prodPage.d,p=spsupport.sites.isSrp();r=r&&!p,r=spsupport.whiteStage.pip?r:r&&parseInt(s)<i.prodPage.l,r=r&&e&&i.prodPage.p!=t||spsupport.sites.validProdImg();var o=spsupport.api.validateInimg(t);return spsupport.sites.su()&&!i.prodPage.s&&(spsupport.p.supportedSite||spsupport.whiteStage.st?r&&o:i.prodPage.p!=t&&o)?(i.prodPage.s=1,i.prodPage.i++,i.pageType="PP",i.prodPage.p=t,i.SRP.reset(),spsupport.sites.offInt(),setTimeout(function(){similarproducts.utilities.sfWatcher.setState("validateSU"),spsupport.api.puPSearch(1,t)},30),1):0},sfButtons:function(){return document.getElementById("sfButtons")},getImagePosition:function(t){var s=spsupport.p,i=spsupport.p.$(t),e=i.position(),r=i.offset(),p=parseInt(r.top);return s.applTb&&(p-=s.applTbVal),{l:parseInt(e.left),t:parseInt(e.top),w:parseInt(i.outerWidth(!0)),h:parseInt(i.outerHeight(!0)),x:parseInt(r.left),y:p}},getMeta:function(t){var s=spsupport.p.$('meta[name = "'+t+'"]');return s.length?s[0].content:""},getLinkNode:function(t,s){var i=0;if(t)for(var e=t,r=0;s>r;r++)if(e){if("A"==e.nodeName.toUpperCase()){i=e;break}e=e.parentNode}return i},textFromNodes:function(t){var s="",i=!1,e="",r=[];return t.each(function(t){e=spsupport.api.getTextOfChildNodes(this),i=!1;for(var p=0;p<r.length;p++)e==r[p]&&(i=!0);i||(s+=" "+e),r[t]=e}),s=s.replace(/\s+/g," "),s=spsupport.p.$.trim(s)},textFromLink:function(t){var s="",i=t;if(-1==t.indexOf("javascript")){var e="(http(s)?)?(://)?("+document.domain+")?((www.)("+document.domain+"))?",r=new RegExp(e,"i");t=t.replace(r,"");var p="",o=t.lastIndexOf("+",t.length-1);p=o>-1?t.substr(0,o):t;var a=p.toLowerCase(),n='a[href *= "'+p+'"], a[href *= "'+a+'"]',u=spsupport.p.$(n);if(0==u.length){var c=t.lastIndexOf("/");c>-1&&(a=t.substr(c+1,i.length-1),n='a[href *= "'+a+'"]',u=spsupport.p.$(n))}s=spsupport.api.textFromNodes(u)}var l=s.split(" ");if(l.length<3){var d=t.lastIndexOf("?",t.length-1),m=d>-1?t.substr(0,d):"";u=spsupport.p.$('a[href *= "'+m+'"]'),s=spsupport.api.textFromNodes(u)}return s},getTextOfChildNodes:function(t){var s="",i;for(i=0;t&&i<t.childNodes.length;i++)3==t.childNodes[i].nodeType&&(s=spsupport.p.$.trim(s+" "+t.childNodes[i].nodeValue)),t.childNodes[i].childNodes.length>0&&(s=spsupport.p.$.trim(s+" "+spsupport.api.getTextOfChildNodes(t.childNodes[i])));return s},vTextLength:function(t){return t?t.length>1e3?"":t.length<320?t:spsupport.p.isIE7?t.substr(0,320):t:""},showDivs:function(){var t=this.sfButtons();spsupport.p.$("div",spsupport.p.$(t)).show()},trimText:function(t){if(!t)return"";var s=200;return"string"==typeof t&&t.length>s?t.substr(0,s):t},getItemJSON:function(t){var s=spsupport.api,i=spsupport.p,e="";try{e=decodeURIComponent(t.src)}catch(r){e=t.src}var p=200,o=200,a;a=spsupport.sites.getRelText(t),(!a||!a.iText||a.iText.length<15)&&t.width>=p&&t.height>=o&&(a=spsupport.sites.getRelTextPP(t)),a&&a.iText&&(a.iText=i.$.trim(a.iText));var n;i.pageType&&"NA"!=i.pageType?n=i.pageType:(n=i.prodPage.i>0?"PP":"SRP",i.pageType=n);var u="PP"==n&&t!=i.prodPage.p?"":document.title+spsupport.api.getMK(t),c=a?s.vTextLength(a.iText):"",l=a&&a.iTitle?a.iTitle:"";l+=" "+t.title+" "+t.alt,l=spsupport.p.$.trim(l);var d=a?a.prodUrl:"",m=similarproducts.b.price.get(t);u=s.trimText(u),l=s.trimText(l),c=s.trimText(c);var g={userid:encodeURIComponent(i.userid),merchantName:encodeURIComponent(s.merchantName()),dlsource:i.dlsource,appVersion:i.appVersion,documentTitle:u.replace(/[']/g,"'").replace(/["]/g,'\\"'),imageURL:encodeURIComponent(spsupport.sites.vImgURL(e)),imageTitle:l.replace(/[']/g,"'").replace(/["]/g,'\\"'),imageRelatedText:c.replace(/[']/g,"'").replace(/["]/g,'\\"'),pr:m,productUrl:encodeURIComponent(d)};return g},getTitleText:function(){var t=spsupport.p.$("title").text().toLowerCase(),s=t.indexOf("review"),i=t.indexOf("|");return-1!==i&&(t=t.substr(0,i)),-1!==s&&(t=5>s?t.split("review")[1]:t.substr(0,s-1)),t},getItemPos:function(t){var s="";try{s=decodeURIComponent(t.src)}catch(i){s=t.src}var e=spsupport.api.getImagePosition(t),r={imageURL:encodeURIComponent(spsupport.sites.vImgURL(s)),x:e.x,y:e.y,w:t.width||t.offsetWidth,h:t.height||t.offsetHeight};return r},getMK:function(t){var s=document.domain.toLowerCase();if((s.indexOf("zappos.com")>-1||s.indexOf("6pm.com")>-1)&&spsupport.p.prodPage.i>0&&spsupport.p.prodPage.p==t){var i=spsupport.p.$('meta[name = "keywords"]');if(i.length){i=i[0].content.split(",");for(var e=i.length>2?i.length-3:i.length-1,r="",p=0;e>=p;p++)r=i[p]+(e>p?",":"");return" [] "+r}}return""},merchantName:function(){return spsupport.p.merchantName},similarproducts:function(){return window.top.similarproducts},sendMessageToExtenstion:function(t,s){var i=document,e=JSON.stringify(s);if(spsupport.p.isIE)try{window.sendMessageToBHO(e,t)}catch(r){}else{var p=i.getElementById("sfMsgId");p||(p=i.createElement("sfMsg"),p.setAttribute("id","sfMsgId"),i.body.appendChild(p)),p.setAttribute("data",e);var o=i.createEvent("Events");o.initEvent(t,!0,!1),p.dispatchEvent(o)}},saveStatistics:function(){var t=spsupport.p;if(!(document.domain.indexOf(similarproducts.b.sfDomain)>-1||"conduit"==t.dlsource||"pagetweak"==t.dlsource||"similarweb"==t.dlsource)){var s={imageCount:t.activeAreas.length,ip:similarproducts.b.ip};spsupport.api.isOlderVersion("1.2.0.0",t.clientVersion)?(s.Url=document.location,s.userid=t.userid,s.versionId=t.clientVersion,s.dlsource=t.dlsource,""!=t.CD_CTID&&(s.CD_CTID=t.CD_CTID),spsupport.api.jsonpRequest(t.sfDomain_+"saveStatistics.action",s)):spsupport.api.sendMessageToExtenstion("SuperFishSaveStatisticsMessage",s)}},isOlderVersion:function(t,s){var i=0,e=t.split("."),r=s.split(".");if(4==e.length&&4==r.length)for(var p=0,o=0;3>=o&&!p&&!i;o++)+e[o]>+r[o]?(i=1,p=1):+e[o]<+r[o]&&(p=1);return i},leftPad:function(t,s,i){for(var e=t+"";e.length<i;)e=s+e;return e},getDateFormated:function(){var t=new Date;return t.getFullYear()+spsupport.api.leftPad(t.getMonth()+1,"0",2)+spsupport.api.leftPad(t.getDate(),"0",2)+""},dtBr:spsupport.dtBr,nofityStatisticsAction:function(t){var s=spsupport.p;""!=s.w3iAFS&&(data.w3iAFS=s.w3iAFS),""!=s.CD_CTID&&(data.CD_CTID=s.CD_CTID),spsupport.api.jsonpRequest(s.sfDomain_+"notifyStats.action",{action:t,userid:s.userid,versionId:s.clientVersion,dlsource:s.dlsource,browser:navigator.userAgent})},unloadEvent:function(){}},spsupport.domHelper={addEListener:function(t,s,i){window.addEventListener?t.addEventListener(i,s,!1):t.attachEvent(i,s,!1)}},spsupport.api.init()}();